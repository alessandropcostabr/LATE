<%- include('partials/header') %>
<body>
  <%- include('partials/navbar') %>

  <main class="main" role="main">
    <div class="container">
      <section class="row align-items-start g-4">
        <div class="col-lg-7">
          <div class="card">
            <div class="card-header">
              <h1 class="card-title">Trocar senha</h1>
              <p class="card-subtitle">Informe sua senha atual e crie uma nova combinação segura.</p>
            </div>
            <div class="card-body">
              <div id="passwordAlert" class="alert d-none" role="alert"></div>

              <form id="passwordChangeForm" class="row g-3" novalidate data-user-email="<%= user?.email || '' %>">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">

                <div class="col-12">
                  <label for="currentPassword" class="form-label">Senha atual</label>
                  <div class="password-field">
                    <input
                      type="password"
                      class="form-control"
                      id="currentPassword"
                      name="currentPassword"
                      required
                      autocomplete="current-password"
                    >
                    <button
                      type="button"
                      class="password-toggle-btn"
                      data-password-toggle="currentPassword"
                      aria-pressed="false"
                    >
                      <span data-password-toggle-label>Mostrar</span>
                    </button>
                  </div>
                </div>

                <div class="col-12 col-md-6">
                  <label for="newPassword" class="form-label">Nova senha</label>
                  <div class="password-field">
                    <input
                      type="password"
                      class="form-control"
                      id="newPassword"
                      name="newPassword"
                      minlength="8"
                      required
                      autocomplete="new-password"
                    >
                    <button
                      type="button"
                      class="password-toggle-btn"
                      data-password-toggle="newPassword"
                      aria-pressed="false"
                    >
                      <span data-password-toggle-label>Mostrar</span>
                    </button>
                  </div>
                </div>

                <div class="col-12 col-md-6">
                  <label for="confirmPassword" class="form-label">Confirmar nova senha</label>
                  <div class="password-field">
                    <input
                      type="password"
                      class="form-control"
                      id="confirmPassword"
                      name="confirmPassword"
                      minlength="8"
                      required
                      autocomplete="new-password"
                    >
                    <button
                      type="button"
                      class="password-toggle-btn"
                      data-password-toggle="confirmPassword"
                      aria-pressed="false"
                    >
                      <span data-password-toggle-label>Mostrar</span>
                    </button>
                  </div>
                </div>

                <div class="col-12 d-flex justify-content-end">
                  <button type="submit" class="btn btn-primary">Salvar nova senha</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <aside class="col-lg-5">
          <div class="card h-100">
            <div class="card-header">
              <h2 class="h5 mb-0">Dicas para uma senha forte</h2>
            </div>
            <div class="card-body">
              <ul class="mb-3 ps-3">
                <li>Utilize pelo menos 8 caracteres combinando letras e números.</li>
                <li>Evite palavras comuns como "teste" ou "senha".</li>
                <li>Não repita trechos do seu e-mail na senha.</li>
                <li>Evite sequências óbvias (12345, qwerty, datas de aniversário).</li>
              </ul>
              <p class="text-muted small mb-0">
                Após salvar, utilize a nova senha na próxima vez que acessar o LATE.
              </p>
            </div>
          </div>
        </aside>
      </section>
    </div>
  </main>

  <%- include('partials/footer') %>
